import { Component, AfterViewInit, ElementRef, ViewChild } from '@angular/core';
import { gsap } from 'gsap';
import { ScrollTrigger } from 'gsap/ScrollTrigger';

gsap.registerPlugin(ScrollTrigger);

@Component({
  selector: 'app-navbar',
  standalone: true,
  templateUrl: './navbar.html',
  styleUrls: ['./navbar.css']
})
export class Navbar implements AfterViewInit {

  @ViewChild('navBar', { static: true }) navBar!: ElementRef;
  @ViewChild('menuItems', { static: true }) menuItems!: ElementRef;

  ngAfterViewInit() {
    // Initial load animation
    gsap.from(this.navBar.nativeElement, {
      y: -80,
      opacity: 0,
      duration: 1,
      ease: 'power3.out'
    });

    // Scroll-triggered shrink effect
    gsap.to(this.navBar.nativeElement, {
      height: '50px', // shrink navbar height
      duration: 0.3,
      ease: 'power2.out',
      scrollTrigger: {
        trigger: document.body,
        start: 'top -20',
        toggleActions: 'play none none reverse'
      }
    });

    // Scale down text inside navbar
    gsap.to(this.navBar.nativeElement.querySelectorAll('.nav-text'), {
      scale: 0.85,
      duration: 0.3,
      ease: 'power2.out',
      scrollTrigger: {
        trigger: document.body,
        start: 'top -20',
        toggleActions: 'play none none reverse'
      }
    });

    // Hide some menu items on scroll
    gsap.to(this.navBar.nativeElement.querySelectorAll('.hide-on-scroll'), {
      opacity: 0,
      y: -20,
      duration: 0.3,
      ease: 'power2.out',
      scrollTrigger: {
        trigger: document.body,
        start: 'top -20',
        toggleActions: 'play none none reverse'
      }
    });
  }
}
